<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>結果 | 集団健康度チェック</title>
    <link href="./css/bootstrap.min.css" rel="stylesheet">
    <link href="./css/custom.css" rel="stylesheet">
    <script src="./js/jquery-3.7.0.min.js"></script>
    <link rel="shortcut icon" href="./favicon.ico">
    <link rel="apple-touch-icon" href="./apple-touch-icon.png">
    <link rel="icon" type="image/png" href="./android-chrome-256x256.png">
  </head>
  <body>

    <!-- ホームへ戻る -->
    <div class="modal fade" id="homeModal" tabindex="-1" aria-labelledby="homeModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="homeModalLabel">ホームへ戻る</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>集団健康度チェックを中断し、記録を消して最初に戻るには以下をクリックしてください。</p>
            <p><a class="btn btn-success btn-lg" href="./">記録を消して最初に戻る</a></p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">閉じる</button>
          </div>
        </div>
      </div>
    </div>

    <!-- 集団健康度チェックについて -->
    <div class="modal fade" id="aboutModal" tabindex="-1" aria-labelledby="aboutModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="aboutModalLabel">集団健康度チェックについて</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>集団健康度チェックは、西田公昭らによって開発されました。</p>
            <p>詳しくは、日本脱カルト協会(JSCPR)編『カルトからの脱会と回復のための手引き（改訂版）』、遠見書房、2014年の付録1「集団健康度測定目録」をご覧ください。</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">閉じる</button>
          </div>
        </div>
      </div>
    </div>

    <!-- 日本脱カルト協会 -->
    <div class="modal fade" id="jscprModal" tabindex="-1" aria-labelledby="jscprModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="jscprModalLabel">日本脱カルト協会</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>日本脱カルト協会(JSCPR)については、日本脱カルト協会のWebサイトをご覧ください。</p>
            <p>日本脱カルト協会のWebサイトは <a href="http://www.jscpr.org/">http://www.jscpr.org/</a> です。<br>
            ※このリンクをクリックすると集団健康度チェックを中断し、日本脱カルト協会のWebサイトに移動します。</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">閉じる</button>
          </div>
        </div>
      </div>
    </div>

    <!-- お問い合わせ -->
    <div class="modal fade" id="contactModal" tabindex="-1" aria-labelledby="contactModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="contactModalLabel">お問い合わせ</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>日本脱カルト協会(JSCPR)へのお問い合わせは、メールもしくはFAXでお願いいたします。</p>
            <p>メール: info★jscpr.org<br>※★を＠（アットマーク）に変更してください。</p>
            <p>FAX: 03-5539-4879</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">閉じる</button>
          </div>
        </div>
      </div>
    </div>

    <!-- プライバシー・ポリシー -->
    <div class="modal fade" id="privacyPolicyModal" tabindex="-1" aria-labelledby="privacyPolicyModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="privacyPolicyModalLabel">プライバシー・ポリシー</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p></p>
            <p>集団健康度チェックの回答データは、ブラウザに保存されます。ブラウザを終了するか最初のページに戻ると、データがブラウザから削除されます。</p>
            <p>チェック終了後にデータをGoogleフォームに送信するボタンが表示されます。これはGoogleフォームにデータを送りたい場合にだけご利用ください。</p>
            <p>このボタンを押すと、Googleフォームが別ウィンドウで開きます。Googleフォームにデータを記入して送信していただくと、Googleフォームにデータが保存されます。</p>
            <p>Googleフォームに保存されたデータは日本脱カルト協会が管理しています。</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">閉じる</button>
          </div>
        </div>
      </div>
    </div>

    <header>
      <!-- Fixed navbar -->
      <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
        <div class="container-fluid">
          <a class="navbar-brand" href="#" data-bs-toggle="modal" data-bs-target="#homeModal">集団健康度チェック</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav me-auto mb-2 mb-md-0">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="#" data-bs-toggle="modal" data-bs-target="#homeModal">ホーム</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#aboutModal">集団健康度チェックについて</a>
              </li>
          </div>
        </div>
      </nav>
    </header>

    <main class="mt-4 pt-5 pb-5" style="margin-bottom: 70px;">
      <div class="container">
        <h1>結果</h1>
        <p class="fs-4"></p>
        
          <p class="fs-2" id="name"></p>
<p class="fs-4" id="relation"></p>
<p class="fs-3">総合健康度&nbsp;<span id="r-10"></span>&nbsp;<span id="v-10"></span></p>

<table class="table">
  <tr><td>I 入脱会の自由に対する侵害</td><td id="r-01"></td><td id="v-01"></td></tr>
  <tr><td>II 信教・思想の自由に対する侵害</td><td id="r-02"></td><td id="v-02"></td></tr>
  <tr><td>III 通信・居住の自由に対する侵害</td><td id="r-03"></td><td id="v-03"></td></tr>
  <tr><td>IV 性・子どもの権利に対する侵害</td><td id="r-04"></td><td id="v-04"></td></tr>
  <tr><td>V 健康・文化的生活の権利に対する侵害</td><td id="r-05"></td><td id="v-05"></td></tr>
  <tr><td>VI 民主教育に対する侵害</td><td id="r-06"></td><td id="v-06"></td></tr>
  <tr><td>VII 組織の民主制に対する侵害</td><td id="r-07"></td><td id="v-07"></td></tr>
  <tr><td>VIII プライバシーに対する侵害</td><td id="r-08"></td><td id="v-08"></td></tr>
  <tr><td>IX その他の人権に対する侵害</td><td id="r-09"></td><td id="v-09"></td></tr>
</table>
<p><a class="btn btn-success btn-lg" href="./">記録を消して最初に戻る</a></p>

<script>
const answers = [
    ['name', 'favorite', 'relation', 'gender', 'age'],
    ['q001', 'q002', 'q003', 'q004', 'q005', 'q006', 'q007', 'q008', 'q009', 'q010', 'q011', 'q012', 'q013', 'q014', 'q015'],
    ['q016', 'q017', 'q018', 'q019', 'q020', 'q021', 'q022', 'q023', 'q024', 'q025'],
    ['q026', 'q027', 'q028', 'q029', 'q030', 'q031', 'q032'],
    ['q033', 'q034', 'q035', 'q036', 'q037', 'q038', 'q039', 'q040', 'q041', 'q042'],
    ['q043', 'q044', 'q045', 'q046', 'q047', 'q048', 'q049', 'q050', 'q051', 'q052', 'q053', 'q054', 'q055', 'q056', 'q057', 'q058', 'q059', 'q060'],
    ['q061', 'q062', 'q063', 'q064', 'q065', 'q066', 'q067', 'q068', 'q069', 'q070'],
    ['q071', 'q072', 'q073', 'q074', 'q075', 'q076', 'q077', 'q078', 'q079', 'q080', 'q081', 'q082', 'q083', 'q084', 'q085', 'q086', 'q087'],
    ['q088', 'q089', 'q090', 'q091', 'q092', 'q093'],
    ['q094', 'q095', 'q096', 'q097', 'q098', 'q099', 'q100', 'q101', 'q102', 'q103', 'q104', 'q105', 'q106', 'q107', 'q108', 'q109', 'q110', 'q111', 'q112', 'q113', 'q114']
];

let indicator = [];
indicator[0] = 0;
for (let i = 1; i < answers.length; i++) {
    let value = 0;
    for (let j = 0; j < answers[i].length; j++) {
        let v = sessionStorage.getItem(answers[i][j]);
        if (v) {
            value += parseInt(v);
        }
    }
    indicator[i] = value;
}

let favorite = parseInt(sessionStorage.getItem('favorite'));
switch (favorite) {
    case 0:
        indicator[1] += 5;
        indicator[2] += 3;
        indicator[3] += 2;
        indicator[4] += 3;
        indicator[5] += 6;
        indicator[6] += 3;
        indicator[7] += 6;
        indicator[8] += 2;
        indicator[9] += 7;
        break;
    case 2:
        indicator[1] -= 5;
        indicator[2] -= 3;
        indicator[3] -= 2;
        indicator[4] -= 3;
        indicator[5] -= 6;
        indicator[6] -= 3;
        indicator[7] -= 6;
        indicator[8] -= 2;
        indicator[9] -= 7;
        break;
}

indicator[10] = 0;
for (let i = 1; i < answers.length; i++) {
    indicator[10] += indicator[i];
}

let rate = '';
rate = 'ふつう';
if (indicator[1] > 15) {
    rate = 'やや不健康';
} else if (indicator[1] > 22) {
    rate = '不健康';
} else if (indicator[1] > 30) {
    rate = '非常に不健康';
}
$('#r-01').html(rate);
$('#v-01').html(indicator[1] + '点');

rate = 'ふつう';
if (indicator[2] > 10) {
    rate = 'やや不健康';
} else if (indicator[2] > 15) {
    rate = '不健康';
} else if (indicator[2] > 20) {
    rate = '非常に不健康';
}
$('#r-02').html(rate);
$('#v-02').html(indicator[2] + '点');

rate = 'ふつう';
if (indicator[3] > 7) {
    rate = 'やや不健康';
} else if (indicator[3] > 11) {
    rate = '不健康';
} else if (indicator[3] > 14) {
    rate = '非常に不健康';
}
$('#r-03').html(rate);
$('#v-03').html(indicator[3] + '点');

rate = 'ふつう';
if (indicator[4] > 10) {
    rate = 'やや不健康';
} else if (indicator[4] > 15) {
    rate = '不健康';
} else if (indicator[4] > 20) {
    rate = '非常に不健康';
}
$('#r-04').html(rate);
$('#v-04').html(indicator[4] + '点');

rate = 'ふつう';
if (indicator[5] > 18) {
    rate = 'やや不健康';
} else if (indicator[5] > 27) {
    rate = '不健康';
} else if (indicator[5] > 35) {
    rate = '非常に不健康';
}
$('#r-05').html(rate);
$('#v-05').html(indicator[5] + '点');

rate = 'ふつう';
if (indicator[6] > 10) {
    rate = 'やや不健康';
} else if (indicator[6] > 15) {
    rate = '不健康';
} else if (indicator[6] > 20) {
    rate = '非常に不健康';
}
$('#r-06').html(rate);
$('#v-06').html(indicator[6] + '点');

rate = 'ふつう';
if (indicator[7] > 17) {
    rate = 'やや不健康';
} else if (indicator[7] > 26) {
    rate = '不健康';
} else if (indicator[7] > 34) {
    rate = '非常に不健康';
}
$('#r-07').html(rate);
$('#v-07').html(indicator[7] + '点');

rate = 'ふつう';
if (indicator[8] > 6) {
    rate = 'やや不健康';
} else if (indicator[8] > 10) {
    rate = '不健康';
} else if (indicator[8] > 12) {
    rate = '非常に不健康';
}
$('#r-08').html(rate);
$('#v-08').html(indicator[8] + '点');

rate = 'ふつう';
if (indicator[9] > 17) {
    rate = 'やや不健康';
} else if (indicator[9] > 26) {
    rate = '不健康';
} else if (indicator[9] > 34) {
    rate = '非常に不健康';
}
$('#r-09').html(rate);
$('#v-09').html(indicator[9] + '点');

rate = 'ふつう';
if (indicator[10] > 50) {
    rate = 'やや不健康';
} else if (indicator[10] > 79) {
    rate = '不健康';
} else if (indicator[10] > 109) {
    rate = '非常に不健康';
}
$('#r-10').html(rate);
$('#v-10').html(indicator[10] + '点');

$('#name').html(sessionStorage.getItem('name'));

$('#relation').html(
(function () {
let favorite = parseInt(sessionStorage.getItem('relation'));
if (favorite === 0) {
    return '現役メンバー';
} else if (favorite === 1) {
    return '元メンバー';
} else if (favorite === 2) {
    return 'メンバーの家族';
} else if (favorite === 3) {
    return 'メンバーの知人';
} else if (favorite === 4) {
    return 'メンバーのその他';
}})()
+ '(' +
(function () {
let favorite = parseInt(sessionStorage.getItem('favorite'));
if (favorite === 0) {
    return '好意的';
} else if (favorite === 1) {
    return 'ふつう';
} else if (favorite === 2) {
    return '否定的';
}})()
+ ')' 
);
</script>
        
      </div>
    </main>

    <footer class="footer pt-3 pb-2 bg-body-secondary fixed-bottom">
      <div class="container">
        <p class="float-start">
          <a href="#" data-bs-toggle="modal" data-bs-target="#jscprModal">日本脱カルト協会(JSCPR)</a>
        </p>
        <p class="float-end">
          <a href="#" data-bs-toggle="modal" data-bs-target="#contactModal">お問い合わせ</a>
            | <a href="#" data-bs-toggle="modal" data-bs-target="#privacyPolicyModal">プライバシー・ポリシー</a>
        </p>
      </div>
    </footer>

    <script src="./js/bootstrap.bundle.min.js"></script>
  </body>
</html>